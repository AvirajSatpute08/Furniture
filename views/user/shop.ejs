<%- include("navbar.ejs") %>

<!-- Start Hero Section -->
<div class="hero">
    <div class="container">
        <div class="row justify-content-between">
            <div class="col-lg-5">
                <div class="intro-excerpt">
                    <h1>Shop</h1>
                </div>
            </div>
            <div class="col-lg-7">
            </div>
        </div>
    </div>
</div>
<!-- End Hero Section -->

<div class="untree_co-section product-section before-footer-section">
    <div class="container">
        <div class="row">
            <% products.forEach(product => { 
                let img = ""; 
                if (Array.isArray(product.product_image) && product.product_image.length > 0) { // Check if product_image exists and is an array
                    img = product.product_image[0]; // Get the first image
                }
            %>
                <!-- Start Column 1 -->
                <div class="col-12 col-md-4 col-lg-3 mb-5">
                    <a class="product-item" href="/product_info/<%= product._id %>"> 
                        <% if(img) { %> <!-- Only render image if it's found -->
                            <img src="/uploads/<%= img %>" alt="Product Image" class="img-fluid product-thumbnail">
                        <% } %>
                        <h3 class="product-title">
                            <%= product.product_name %>
                        </h3>
                        <strong class="product-price">
                            <% const number = product.product_price; 
                            const currency = 'INR'; 
                            const formatter = new Intl.NumberFormat('en-IN', {
                                style: 'currency', 
                                currency: currency,
                                minimumFractionDigits: 0,
                                maximumFractionDigits: 0,
                            }); 
                            const formattedNumber = formatter.format(number); %>
                            <%= formattedNumber %>
                        </strong>
                        <span class="icon-cross">
                            <img src="images/cross.svg" class="img-fluid" alt="Cross Icon">
                        </span>
                    </a>
                </div>
                <!-- End Column 1 -->
            <% }); %>
        </div>
        <style>
            .btn-light {
                background-color: white;
                border: 1px solid black;
                color: black;
            }
            .btn-primary {
                background-color: blue;
                color: white;
            }
        </style>
        <div class="row">
            <div class="col-md-12 text-center">
                <% for(let i = 1; i <= total_pages; i++) { %>
                    <a href="/shop?page_no=<%= i %>">
                        <button class="btn <%= (page_no == i) ? 'btn-primary' : 'btn-light' %>"><%= i %></button> 
                    </a>
                <% } %>
            </div>
        </div>
    </div>
</div>

<%- include("footer.ejs") %>